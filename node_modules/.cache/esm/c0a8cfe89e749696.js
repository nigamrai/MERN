let CustomErrorHandler,jwtServices;_9e7‍.x([["isLoggedIn",()=>isLoggedIn],["authorizedRoles",()=>authorizedRoles]]);_9e7‍.w("../services/customErrorHandler",[["default",["CustomErrorHandler"],function(v){CustomErrorHandler=v}]]);_9e7‍.w("dotenv/config");_9e7‍.w("../services/jwtServices",[["default",["jwtServices"],function(v){jwtServices=v}]]);


 const isLoggedIn=async(req,res,next)=>{
    const {token}=req.cookies;
    if(!token){
        return next(new CustomErrorHandler.unAuthenticated());
    }
    const userDetails= jwtServices.verify(token);
    
    req.user=userDetails;
    next();
}
 const authorizedRoles=(...roles)=>{
    async(req,res,next)=>{
        if(!roles.includes(req.user.role)){
            return next(CustomErrorHandler.unAuthorized());
        }
    next();
    }
}
 